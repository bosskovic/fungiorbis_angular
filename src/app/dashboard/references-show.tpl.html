<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">
            <a ui-sref="dashboard.references">
                <fo-icon icon="backHistory"></fo-icon>
                <fo-icon icon="references"></fo-icon>
            </a>
            {{ reference.authors }}: {{ reference.title }}
        </h1>
    </div>
</div>

<div class="row" ng-hide="true">
    <div class="col-lg-12">
        <div class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <i class="fa fa-exclamation-triangle"></i> <strong>Error!</strong> Error message text here...
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <table class="table">
            <tr ng-repeat="field in referenceCtrl.fields">
                <th class="text-nowrap">{{field.header}}</th>
                <td class="text-nowrap">
                    <a class="pointer"
                       editable-text="reference[field.field]"
                       onbeforesave="updateField(field.field, $data)">{{reference[field.field] ||
                        field.placeholder}}</a>
                </td>
                <td class="full-width"></td>
            </tr>
            <tr>
                <th class="text-nowrap">Species characteristics</th>
                <td>{{ reference.characteristics.length }}</td>
                <td></td>
            </tr>
        </table>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <fo-typeahead id="speciesId" value="speciesFullName" properties="referenceCtrl.typeAheadProperties"></fo-typeahead>
    </div>
</div>

<div class="row auto-width" ng-class="{'new-characteristic-box': speciesId}" ng-switch on="speciesId === undefined">
    <div class="col-lg-12 auto-width" ng-switch-when="false">
        <em class="dimmed" ng-show="characteristic.id">Existing record: </em>
        <em class="dimmed" ng-hide="characteristic.id">New record: </em>
        <em class="dimmed">{{ speciesFullName }}</em>

        <fo-characteristic-edit characteristic="characteristic"></fo-characteristic-edit>

        <button class="btn btn-primary" ng-click="referenceCtrl.saveCharacteristic()"
                ng-disabled="!dirty || emptyParams">
            <fo-icon icon="confirm"></fo-icon>
            Save
        </button>
        <button class="btn btn-primary" ng-click="referenceCtrl.reset()">
            <fo-icon icon="cancel"></fo-icon>
            Reset and close
        </button>
    </div>
</div>


<div class="row species-characteristics-row" ng-show="reference.characteristics.length > 0">
    <div class="col-lg-12">
        <fo-characteristics-table
                parent="species"
                parent-id="speciesId"
                characteristic="characteristic"
                characteristics="reference.characteristics"
                characteristic-row="characteristicRow"
                reset-dialog="resetDialog"
                delete-dialog="deleteDialog"
                save-characteristic="referenceCtrl.saveCharacteristic"
                reset="referenceCtrl.reset"></fo-characteristics-table>
    </div>
</div>